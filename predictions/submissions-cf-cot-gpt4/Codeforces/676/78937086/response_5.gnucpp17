#include <iostream>
#include <vector>
#include <array>
#include <string>
typedef long long ll;
typedef std::pair<int, int> pii;
typedef std::pair<ll, ll> pll;
typedef std::vector<int> vi;
typedef std::vector<ll> vl;
typedef std::vector<pii> vii;
typedef std::vector<pll> vll;
constexpr int mod1 = 1000000007;
constexpr int mod2 = 1000000009;
constexpr int mod3 = 37;
constexpr int mod4 = 715827883;
std::array<int,12> TestMillerRabin = {2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37};

//... code here is same as before

int main() {
  std::ios::sync_with_stdio(false);
  std::cin.tie(nullptr);
  //...
  for (int i = 0; i < n + 1; i++) {
    std::string s;
    std::cin >> s;
    if (i == 0)
      p = s;
    if (s != "?")
      played++;
    values.emplace_back(s);
  }
  //... code here is same as before
}