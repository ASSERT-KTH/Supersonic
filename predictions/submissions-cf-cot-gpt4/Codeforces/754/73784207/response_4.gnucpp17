#include <iostream>
#include <vector>
#include <map>
#include <algorithm>
#include <climits>

using namespace std;
typedef long long ll;
typedef pair<ll, ll> pll;

const int N = 1e5 + 5;
vector<pll> v;
map<ll, int> mp;
vector<ll> inv_map(N);
int n, k;
vector<int> segtree(4 * N, 0), lazy(4 * N, 0);

// rest of the code from 'spread' function to main remains the same...