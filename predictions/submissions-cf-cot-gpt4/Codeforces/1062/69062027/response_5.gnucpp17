#include <iostream>
#include <vector>
#include <algorithm>
#include <set>
#include <chrono>
#include <random>

using namespace std;

typedef long long int64;
typedef long double ld;
typedef vector<int> vi;
typedef pair<int, int> pi;
typedef vector<pi> vpi;
const int MAXN = 100100;
const int mod = 1000000007;

vector<vector<int>> adj;
int n, a[MAXN], q;
struct dat {
  pair<int, int> mx;
  pair<int, int> mn;
} t[4 * MAXN];
dat zero;

// ... rest of your code remains unchanged ...