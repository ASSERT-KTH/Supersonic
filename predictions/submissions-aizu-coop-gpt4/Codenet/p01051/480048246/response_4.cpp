if (d[p.second] < p.first) continue;