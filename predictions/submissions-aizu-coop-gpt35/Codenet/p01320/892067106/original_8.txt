Code Analysis:
- The code includes multiple header files, but only a few are actually used in the code.
- The code includes a large number of unnecessary typedefs and macros, which can make the code harder to read and understand.
- The code contains a lot of unnecessary operators and functions overload for outputting data structures, which adds unnecessary complexity.
- The code uses a lot of unnecessary data structures and functions related to geometric calculations, which are not used in the given problem.

Optimization Strategy:
1. Remove unnecessary header files: The code includes multiple header files that are not used in the code. Removing these unnecessary header files will reduce the compilation time and improve the overall performance.

2. Remove unnecessary typedefs and macros: The code includes a large number of typedefs